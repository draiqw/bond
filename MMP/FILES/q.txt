Данные уже отсортированы в хронологическом порядке
по каждому эмитенту надо

что взять:
 1. BID|OFFER stocks|futures price0|quantity0
 2. создать облигацию = (цену фьючерса / цена акции - 1) * 100 % -- это цена облигации
  2.1. на покупку! это Bids-futures / offer-stocks
  2.2. на продажу! это Offer-futures / bid-stocks
 3. кол-во доступное в облигации = min(кол-ва фьюей и акций)

что сделать для начала:
 1. возьмите например первый месяц
 2. обучите модель(ки)
  1. например на предсказание временного ряда
  2. или какюу-либо другую вероятность отклонения от тренда
   (напоминаю что эти числа у вас "хорошие", они будут сходиться к нулю)
 3. вам нужно в каждый момент времени (каждый сэмпл датасета) принимать решение: купить, продать или держать

 4. метрика продуктовая -- максимизация прибыли. пока что можете взять так: пусть есть какие-то 1к рублей (хотя мы не рублями торгуем...)
  считайте что покупаете эту облигацию, потом её же продаете но по цене продажи!
  при этом у нас образуется прибыль от покупки подороже и продажи подешевле (потому что мы играем в шорт здесь)

Всё было бы не так плохо, если бы не комиссии ))
Считайте что комиссия на покупку это 0.23/2
На продажу аналогичная

Производится на каждом действии согласно кол-ву разумеется

Практически вам нужны две составляющие :
1. Какой-то контролер состояния: баланс, кол-во в портфеле и остальная метаинформация
2. Предсказатель (ряда, экшена, вероятности)

По факту задача не имеет таргета — в этом её сложность
Вам нужно его придумать самим!

Мой совет-стратегия на попробовать:
Маленький EDA: Отрисовать ряды (я не рисовал если что) для представления в целом о ситуации

Проставить таргет: например что значение ряда выше тренда на комиссию * какой-то ваш кэф

Обучить модельку  на это классификационную
В каждый момент времени определять отклонение тренда, насколько оно сильно (нагенерить чутка признаков про всякие средние и отклонения)

Посчитать классификационные метрики

Просимулировать торги и посчитать прибыль

по идее вам самое простое начать с тупо линейной регрессии (есть вероятность что это самое прибыльное дело, кек)

и построить тренд
и по вероятности оценивать покупку/продажу

идти скользящим окном или нарастающим по данным
и в каждый момент времени принимать решение о действии

Практически вам нужны две составляющие :
1. Какой-то контролер состояния: баланс, кол-во в портфеле и остальная метаинформация
2. Предсказатель (ряда, экшена, вероятности)
Концептуально, задача не имеет таргета
Вам нужно его поставить самим

Мой совет-стратегия на попробовать:
Маленький EDA: Отрисовать ряды (я не рисовал если что) для представления в целом о ситуации

Проставить таргет: например что значение ряда выше тренда на комиссию * какой-то ваш кэф

Обучить модельку  на это классификационную
В каждый момент времени определять отклонение тренда, насколько оно сильно (нагенерить чутка признаков про всякие средние и отклонения)


Посчитать классификационные метрики

Просимулировать торги и посчитать прибыль

Оффер — это предложение
Вы его покупаете типа
Типа
Bid-futures / offer-stocks
Offer-futures / bid-stocks
Например
Вы покупаете созданную вами облигацию по  4.5 7шт платите 0.23/2 *7 комсу

Потом продаете облигу по 4.2, тоже платите за каждую по 0.23/2

Получается 4.5-4.2-0.23 =0,07  прибыль (можно на *7) чтоб получить итог и прибавить в кэш
Там важно понимать что на что делить
Я написал в закрепе или ниже него


Здесь ещё раз подмечу диссонанс который может возникать:
Что мы играем на понижении рынка, поэтому мы покупаем Дороже, продаем Дешевле
И на этом выигрываем (это правильно)

небольшой экскурс почему мы играем не как привыкли все, а наоборот: покупаем дороже, продаём дешевле.
потому что наш инструмент -- синтетическая облигация
она состоит из фьюча и акции

Цена облиги может быть отрицательной когда цена фьюча < цены акции
Мы не лезем туда
потому что экономически обосновано что цена облиги сходится к нулю


Играем на понижении облиги, тк при этом образуется шорт по фьючу и лонг по акции, и мы можем при одной сумме денег входить только в акции, не тратясь на фьюч. то есть на нас работает обеспечение по акции.
Если бы мы делали обратную операцию, то у нас было бы плечо, и комиссия была бы еще больше (плюс маржин колл по позици на переход между днями)... кароч там всё херово. для физиков, нам выгодно только шортить.

Дабы вас не загружать этим, и упроситить задачу мы оперируем одним только термином: торговлей синтетической облигацией
поскольку она сходится в ноль, мы зарабатываем когда шортим по ней ! (то есть купили дороже, продали дешевле)
Поэтому прибыль высчитывается как Покупка -- Продажа
а не наоборот

не пытайтесь щас в это въехать
еще успееете во время научки
щас главное таску сделать корректно

поэтому ПЕРЕПРОВЕРЬТЕ (кинете еще потом мне код что я отсмотрел)
что вы прибыль считаете как Покупка -- продажа!
Давайте помимо всех комментов которые дал каждому еще мини-ресерч вставите, чтобы не стыдно было показывать
а то щас вы чисто запрогали (и научности никакой нет)

1. ПЕрепроверяете торговлю согласно описанию выше
2. графики чтобы были как ведет себе цена (будет красиво в отчете смотреться, все любят графики) (уже сделали)
3. приведете график сетки: в зависимости от трешхолда, сколько качество получается на метриках, и сколько денег прибыли
 - трешхолд у Ромы вроде был какой-то. вот по нему перебор
 - трешхолд у Сани это трешхолд по вероятности (у логистической регрессии) сигнал расставляешь в зависимости от него
на основании него можно будет сделать вывод что лучше выбрать

4. фича-импортанс еще вставите потом (подскажу как если не разеберетесь). раз взяли линейные модели параметр coef_ кажется... там веса модели -- по ней фича импортанс отпишите

по факту вам сделать 3 и 4 пункты -- супер-изи
и будет четко

Вот условие задачи, это уже существующая задача. Посмотри внимательно и ответь на мои вопросы
